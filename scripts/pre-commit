#!/bin/bash
# Pre-commit hook para bloquear commits com erros
# Instale: cp scripts/pre-commit .git/hooks/pre-commit && chmod +x .git/hooks/pre-commit

echo "üîç Verificando c√≥digo antes do commit..."

# TypeScript check r√°pido
echo "  üì¶ Type checking..."
if ! npx tsc --noEmit 2>/dev/null; then
    echo ""
    echo "  ‚ùå COMMIT BLOQUEADO: Erros de TypeScript detectados"
    echo "  ‚îî‚îÄ Execute 'npx tsc --noEmit' para ver os erros"
    echo ""
    exit 1
fi

# Check for mock data
MOCK_COUNT=$(grep -rE "mockData|dummyPatients|fakeData" app components lib --include="*.ts" --include="*.tsx" 2>/dev/null | wc -l || echo 0)
if [ "$MOCK_COUNT" -gt 0 ]; then
    echo ""
    echo "  ‚ùå COMMIT BLOQUEADO: Dados mock encontrados ($MOCK_COUNT)"
    echo "  ‚îî‚îÄ Remova todos os dados mock antes de commitar"
    echo ""
    exit 1
fi

echo "  ‚úÖ Verifica√ß√µes passaram - commit permitido"
exit 0
